plugins {
    id "com.github.johnrengelman.shadow" version "6.0.0"
    id "com.bmuschko.nexus" version "2.3.1"
}

subprojects {
    apply plugin: 'java'
    apply plugin: 'maven-publish'
    apply plugin: 'com.github.johnrengelman.shadow'
    apply plugin: 'com.bmuschko.nexus'

    group = "io.github.portlek"
    version = properties.configsVersion

    sourceCompatibility = '1.8'
    targetCompatibility = '1.8'

    repositories {
        mavenCentral()
        jcenter()
        maven {
            url 'https://jitpack.io/'
        }
    }

    dependencies {
        implementation("io.github.portlek:reflection:3.1.2")
        implementation("com.github.Carleslc:Simple-YAML:1.6.1")
        compileOnly("org.jetbrains:annotations:19.0.0")
        compileOnly("org.projectlombok:lombok:1.18.12")
        annotationProcessor("org.projectlombok:lombok:1.18.12")
        testCompile("org.junit.jupiter:junit-jupiter:5.6.2")
    }

    shadowJar {
        minimize()
        setArchivesBaseName(this.name)
        archiveClassifier.set("")
        archiveVersion.set("")
    }

    modifyPom {
        project {
            name 'configs'
            description 'Annotation based configuration library for any Java project.'
            url 'https://github.com/portlek/configs'
            inceptionYear '2019'

            scm {
                url 'https://github.com/portlek/configs'
                connection 'scm:git:git://github.com/portlek/configs.git'
                developerConnection 'scm:git:ssh://github.com/portlek/configs.git'
            }

            licenses {
                license {
                    name 'MIT License'
                    url 'https://opensource.org/licenses/mit-license.php'
                    distribution 'repo'
                }
            }

            developers {
                developer {
                    id 'portlek'
                    name 'Hasan Demirta≈ü'
                    email 'utsukushihito@outlook.com'
                    url 'https://github.com/portlek'
                    roles {
                        role 'Architect'
                        role 'Developer'
                    }
                    timezone '+3'
                }
            }

        }
    }

    extraArchive {
        sources = false
        tests = true
        javadoc = false
    }

    nexus {
        sign = true
        repositoryUrl = 'https://oss.sonatype.org/service/local/staging/deploy/maven2/'
        snapshotRepositoryUrl = 'https://oss.sonatype.org/content/repositories/snapshots/'
    }

    task gradleVersion(type: Wrapper) {
        gradleVersion = '6.5.1'
    }
}
